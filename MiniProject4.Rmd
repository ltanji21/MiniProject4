---
title: "The Ignored Women of Hollywood"
author: "Leigh Tanji, Samantha Bryce"
date: '`r format(Sys.Date(), "%B %e, %Y")`'
output: 
  html_document:
    theme: "journal"
    code_folding: hide
    fig_width: 6 
    fig_height: 2.5
    figure_caption: true
---
```{r}
#loading libraries
suppressMessages(library(mdsr))
suppressMessages(library(RMySQL))
suppressMessages(library(dplyr))
suppressMessages(library(ggplot2))

#Getting information on directors. 
all_directors <- dbConnect_scidb(dbname = "imdb")
class(all_directors)

all_directors <- all_directors %>%
  dbGetQuery("SELECT person_id, movie_id, role_id
             FROM cast_info 
             WHERE role_id = 8;")

#Filing in Movie titles in `directors` table. 
movies <- dbConnect_scidb(dbname = "imdb")
class(movies)


movies <- movies %>%
  dbGetQuery("SELECT id, title, kind_id, production_year
             FROM title
             WHERE kind_id = 1;")

list2env(movies, envir = .GlobalEnv)
movies <- rename(movies, movie_id = id)


movie_directors <- all_directors %>%
  inner_join(movies, by = "movie_id")

#Combining information about the directors to the 'movie_directors' table. 
director_info <- dbConnect_scidb(dbname = "imdb")
class(director_info)


director_info<- director_info %>%
  dbGetQuery("SELECT id, name, gender 
             FROM imdb.name;")

list2env(director_info, envir = .GlobalEnv)

director_info<- rename(director_info, person_id = id)

all_directors_info <- movie_directors %>%
  inner_join(director_info, by = "person_id")

#Get number of directors per year. 
director_no <- all_directors_info %>%
  group_by(production_year) %>%
  filter(is.na(gender) & production_year >= 1896 & production_year <= 2017) %>%
  summarize(no_directors = n())

#Joining the number of firectors total table to number of female directors table. 
female_director_no <- all_directors_info %>%
  group_by(production_year) %>%
  filter(gender == "f" & production_year >= 1896 & production_year <= 2017) %>%
  summarize(female_director = n())

#Getting the percentage of female directors by year. 
female_director_ratio <- female_director_no %>%
  inner_join(director_no, by = "production_year") %>%
   group_by(production_year) %>%
  summarise(ratio_f_directors = (female_director/no_directors)*100)
  
#Making a ggplot of ratio of females per year.
female_director_graph <- ggplot(female_director_ratio, aes(x = production_year, y = ratio_f_directors)) + 
  geom_point(alpha = .3) +
  ylab("percentage of female directors") + 
  xlab("Production Year") + 
  ggtitle("percentage of films produced by women per year") +
  geom_line()
```

![Photo-illustration: Maya Robinson and Photos by Getty Images](http://pixel.nymag.com/imgs/daily/vulture/2015/11/02/02-female-directors-lede-3.jpg)

```{r error=FALSE, message=FALSE, warning=FALSE, include=FALSE}
#loading libraries
suppressMessages(library(mdsr))
suppressMessages(library(RMySQL))
suppressMessages(library(dplyr))
suppressMessages(library(ggplot2))

#Getting information on directors. 
all_directors <- dbConnect_scidb(dbname = "imdb")
class(all_directors)

all_directors <- all_directors %>%
  dbGetQuery("SELECT person_id, movie_id, role_id
             FROM cast_info 
             WHERE role_id = 8;")

#Filing in Movie titles in `directors` table. 
movies <- dbConnect_scidb(dbname = "imdb")
class(movies)


movies <- movies %>%
  dbGetQuery("SELECT id, title, kind_id, production_year
             FROM title
             WHERE kind_id = 1;")

list2env(movies, envir = .GlobalEnv)
movies <- rename(movies, movie_id = id)


movie_directors <- all_directors %>%
  inner_join(movies, by = "movie_id")

#Combining information about the directors to the 'movie_directors' table. 
director_info <- dbConnect_scidb(dbname = "imdb")
class(director_info)


director_info<- director_info %>%
  dbGetQuery("SELECT id, name, gender 
             FROM imdb.name;")

list2env(director_info, envir = .GlobalEnv)

director_info<- rename(director_info, person_id = id)

all_directors_info <- movie_directors %>%
  inner_join(director_info, by = "person_id")

#Get number of directors per year. 
director_no <- all_directors_info %>%
  group_by(production_year) %>%
  filter(is.na(gender) & production_year >= 1896 & production_year <= 2017) %>%
  summarize(no_directors = n())

#Joining the number of firectors total table to number of female directors table. 
female_director_no <- all_directors_info %>%
  group_by(production_year) %>%
  filter(gender == "f" & production_year >= 1896 & production_year <= 2017) %>%
  summarize(female_director = n())

#Getting the percentage of female directors by year. 
female_director_ratio <- female_director_no %>%
  inner_join(director_no, by = "production_year") %>%
   group_by(production_year) %>%
  summarise(ratio_f_directors = (female_director/no_directors)*100)
  
#Making a ggplot of ratio of females per year.
female_director_graph <- ggplot(female_director_ratio, aes(x = production_year, y = ratio_f_directors)) + 
  geom_point(alpha = .3) +
  ylab("percentage of female directors") + 
  xlab("Production Year") + 
  ggtitle("percentage of films produced by women per year") +
  geom_line()
  

#Graphic of Oscar best film wining movies by female directors. 
female_director_graph_best_film <- ggplot(female_director_ratio, aes(x = production_year, y = ratio_f_directors)) + 
  geom_point(alpha = .3) +
  ylab("Percentage of female directors") + 
  xlab("Production Year") + 
  ggtitle("Percentage of films produced by women per year") +
  geom_line() + geom_point(x = 2009, y = 16.2118126, colour = "green", size = 3) + geom_point(x = 1990, y = 13.4910751, colour = "green", size = 3) + geom_point(x = 1986, y = 13.6427567, colour = "green", size = 3) + geom_point(x = 2006, y = 16.4701098, colour = "green", size = 3) + geom_point(x = 2003, y = 16.1591751, colour = "green", size = 3) + geom_point(x = 2014, y = 15.4604567, colour = "green", size = 3) + geom_point(x = 2009, y = 17, colour = "red", size = 3) + geom_point(x = 2010, y = 15.0344761, colour = "green", size = 3) + geom_point(x = 1993, y = 15.0041220, colour = "green", size = 3) + geom_point(x = 1991, y = 15.9719356, colour = "yellow", size = 3) + geom_point(x = 2010, y = 16, colour = "green", size = 3) + geom_point(x = 2012, y = 15.4001950, colour = "green", size = 3) + scale_y_continuous(limits = c(0, 20)) + scale_x_continuous(limits = c(1985, 2017))

```

With recent films like Wonder Women and iconic actors ranging from Helen Mirren to Jennifer Lawrence, it is starting to feel like women have actually found their place in Hollywood. However, this isn’t necessarily reality. Here we explore the gender gap of directors in Hollywood and how even today in 2017 women are the silent minority.

Here we have a graph that shows the percentage of films being released each year that have female directors. As of yet we can not explain the spike around 1900 but we hypothesize that this is a product of the film industries using different classifications in the early 1900s. If we ignore the spike in the 1900s, there is a general positive trend. Women are directing more and more movies, which is a great step forward.

```{r, error=FALSE, message=FALSE, warning=FALSE}
female_director_graph <- ggplot(female_director_ratio, aes(x = production_year, y = ratio_f_directors)) + 
  geom_point(alpha = .3) +
  ylab("% Female Directors") + 
  xlab("Production Year") + 
  ggtitle("Percentage of Films Directed by Women by Year & Nominations") +
  geom_line() + 
  geom_point(x = 2009, y = 16.2118126, colour = "green", size = 1) + 
  geom_point(x = 1990, y = 13.4910751, colour = "green", size = 1) +
  geom_point(x = 1986, y = 13.6427567, colour = "green", size = 1) + 
  geom_point(x = 2006, y = 16.4701098, colour = "green", size = 1) + 
  geom_point(x = 2003, y = 16.1591751, colour = "green", size = 1) + 
  geom_point(x = 2014, y = 15.4604567, colour = "green", size = 1) + 
  geom_point(x = 2010, y = 15.0344761, colour = "green", size = 1) + 
  geom_point(x = 1993, y = 15.0041220, colour = "green", size = 1) + 
  geom_point(x = 1991, y = 15.9719356, colour = "green", size = 1) + 
  geom_point(x = 2012, y = 15.4001950, colour = "green", size = 1) 
  
female_director_graph 
```


This might lead to the logical jump forward that women’s work in Hollywood is also being celebrated with a greater frequency. With this in mind we examined movies that have received Best Picture nominations at the Oscars… Our findings were abysmally sad with there only being 12 films in the history of the Oscars to be directed by a woman and nominated for Best Picture. Even more upsetting is that none of these movies ever won Best Picture.

All of our data analysis thus far brought us to the Bechdel test, The Bechdel test is the result of a 1985 comic and is a simple test to see if a film has some level of gender equality. The test has three criteria:
1. The film has two women
2. The two women talk to each other
3. The women talk to each other about something other than a man/men.
Based on user-generated data on the Bechdel test’s website less than 60% of films analyzed have passed the test and if you omit data from films in the past few decades the numbers are much lower.

In contrast to the overall low passing rate of the Bechdel test, 90% of the female directed nominees for Best Picture pass the Bechdel test. Here you can see the same percentage graph from earlier with the female directed nominees denoted with round points. Points in green passed the Bechdel test, the point in red failed, and the point in yellow has not yet been evaluated the Bechdel test.

```{r, warning=FALSE}
#Making the table for Oscar winning, female directed movies. 

Oscar_Winners <- c("3420538", "3901612", "4200072", "4369038", "4374245", "4408215", "4565524", "4590482",
"4404940", "3890366", "3280928", "3314581")

Oscars_directors_info <- all_directors_info %>%
  filter(movie_id %in% Oscar_Winners)%>%
  select(production_year, title, name, gender) %>%
  arrange(desc(production_year))


Oscars_directors_info
```

So what can we do based on this data? One important thing is to recognize and support movies that have females in important off-screen roles like director, writer and producer. Show movie companies that you want to see women involved in not just movies in general but also the big budget films that often end up receiving critical acclaim.


```{r, message=FALSE, error= FALSE, warning=FALSE}
female_director_graph_best_film <- ggplot(female_director_ratio, aes(x = production_year, y = ratio_f_directors)) + 
  geom_point(alpha = .3) +
  ylab("% Female Directors") + 
  xlab("Production Year") + 
  ggtitle("Percentage of Female Directors per year and nominations") +
  geom_line() + geom_point(x = 2009, y = 16.2118126, colour = "green", size = 3) + geom_point(x = 1990, y = 13.4910751, colour = "green", size = 3) + geom_point(x = 1986, y = 13.6427567, colour = "green", size = 3) + geom_point(x = 2006, y = 16.4701098, colour = "green", size = 3) + geom_point(x = 2003, y = 16.1591751, colour = "green", size = 3) + geom_point(x = 2014, y = 15.4604567, colour = "green", size = 3) + geom_point(x = 2009, y = 17, colour = "red", size = 3) + geom_point(x = 2010, y = 15.0344761, colour = "green", size = 3) + geom_point(x = 1993, y = 15.0041220, colour = "green", size = 3) + geom_point(x = 1991, y = 15.9719356, colour = "yellow", size = 3) + geom_point(x = 2010, y = 16, colour = "green", size = 3) + geom_point(x = 2012, y = 15.4001950, colour = "green", size = 3) + scale_y_continuous(limits = c(0, 20)) + scale_x_continuous(limits = c(1985, 2017))
  
female_director_graph_best_film 
```













