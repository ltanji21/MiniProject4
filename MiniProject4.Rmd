---
title: "The Ignored Women of Hollywood"
author: "Leigh Tanji, Samantha Bryce"
date: '`r format(Sys.Date(), "%B %e, %Y")`'
output: 
  html_document:
    theme: "journal"
    code_folding: hide
    fig_width: 6 
    fig_height: 2.5
    figure_caption: true
---
```{r Data Wrangling, message=FALSE, warnings = FALSE}
#loading libraries
suppressMessages(library(mdsr))
suppressMessages(library(RMySQL))
suppressMessages(library(dplyr))
suppressMessages(library(ggplot2))

#**GETTING FEMALE DIRECTORS**
#Getting information on directors from cast info. 
db <- dbConnect_scidb(dbname = "imdb")

all_directors <- db %>%
  dbGetQuery("SELECT person_id, movie_id, role_id
             FROM cast_info
             WHERE role_id = 8;")

#Getting information on female movie people's id, name, and gender from 'imdb.name' 
director_info<- db %>%
  dbGetQuery("SELECT id, name, gender 
             FROM imdb.name
             WHERE gender = 'f';")

director_info <- rename(director_info, person_id = id)

#Combining information about female movie people and just directors to get more information about female directors.
all_dirctor_info <- all_directors %>%
  inner_join(director_info, by = "person_id")

#**GETTING GLOBAL MOVIES**
#Getting infomation on all movies. Since there's a lot of movies, we need more info on these movies. 
movies <- db %>%
  dbGetQuery("SELECT DISTINCT id, title, kind_id, production_year
             FROM title
             WHERE kind_id = 1;")
movies <- rename(movies, movie_id = id)

#Getting info about movie runtimes.
movie_runtime <- db %>%
  dbGetQuery("SELECT movie_id, info
             FROM imdb.movie_info 
             WHERE info_type_id = 1 AND info >= 80
             GROUP BY movie_id;")

#merging info about movies with runtimes over 80minutes and movie title, and movie id.  
actual_movies <- movie_runtime %>%
  inner_join(movies, by = "movie_id")

actual_movies <- actual_movies %>%
  group_by(movie_id, production_year) %>%
  filter(!is.na(production_year))

#**COMBINING FEMALE DIRECTORS AND MOVIES**
movie_f_directors <- actual_movies %>%
  inner_join(all_dirctor_info, by = "movie_id")

#cutting out runtime, kind_id, movie_id, person_id, role_id, and getting number of female directed movies per year.
no_movie_f_directors <- movie_f_directors %>%
  group_by(production_year) %>%
  filter(production_year >= 1896 & production_year <= 2016) %>%
  summarize(n_female_directors = n())

#**GETTING number of directors per year GLOBALLY** 
director_no <- all_directors %>%
  inner_join(actual_movies, by = "movie_id") %>%
  group_by(movie_id) %>%
  filter(!is.na(production_year))

yearly_director_no <- director_no %>%
  group_by(production_year) %>%
  filter(production_year >= 1896 & production_year <= 2016) %>%
  summarize(n_directors = n())

#Getting the percentage of female directors by year. 
female_director_ratio <- no_movie_f_directors %>%
  inner_join(yearly_director_no, by = "production_year") %>%
  group_by(production_year) %>%
  summarise(ratio_f_directors = (n_female_directors/n_directors)*100)
 
#Making a ggplot of ratio of females per year.
female_director_graph <- ggplot(female_director_ratio, aes(x = production_year, y = ratio_f_directors)) + 
  geom_point(alpha = .3) +
  ylab("percentage of female directors") + 
  xlab("Production Year") + 
  ggtitle("percentage of films produced by women per year") +
  geom_line() + theme(text=element_text(family="Times"))
```

![Photo-illustration: Maya Robinson and Photos by Getty Images](http://pixel.nymag.com/imgs/daily/vulture/2015/11/02/02-female-directors-lede-3.jpg)

As Charlize Theron defies her cult leader *in Mad Max: Fury Road* and Gal Gadot smashes the god of war in *Wonder Woman*, women seem to have finally found their place in Hollywood. However, the fictional women on screen only shroud the substantial struggle for recognition of the women the behind the scenes. In 2017, female directors are still the marginalized minority. 

Here we have a graph that shows the percentage of films being released each year that have female directors. As of yet we can not explain the spike around 1900 but we hypothesize that this is a product of the film industries using different classifications in the early 1900s. If we ignore the spike in the 1900s, there is a general positive trend. Women are directing more and more movies, which is a great step forward.

```{r, error=FALSE, message=FALSE, warning=FALSE, fig.width= 10, fig.height= 5, fig.align="center"}
#Graphic of Oscar best film wining movies by female directors. 
female_director_graph_best_film <- ggplot(female_director_ratio, aes(x = production_year, y = ratio_f_directors)) + 
  geom_point(alpha = .3) + 
  theme_bw() +
  ylab("% Female Directors") + 
  xlab("Production Year") + 
  ggtitle("Annual Percentage of Female Directed Films") +
  geom_line() + 
  labs(caption = "Percentages of female directed films by year.") +
  theme(plot.caption = element_text(hjust=0, size=8)) +
  scale_y_continuous(limits = c(0, 9)) + 
  scale_x_continuous(limits = c(1920, 2016)) + theme(text=element_text(family="Times")) +
  annotate("text", x = 1926, y = 5.5, label = "2nd Woman elected into Congress", size = 3) +
  annotate("text", x = 1939, y = 2, label = "WWII starts", size = 3) + 
  geom_segment(aes(x = 1939, y = 0.7, xend = 1939, yend = 1.8)) +
  annotate("text", x = 1945, y = 0, label = "WWII Ends", size = 3) +
  geom_segment(aes(x = 1945, y = 0.2, xend = 1945, yend = 0.7)) +
  annotate("text", x = 1946, y = 3.4, label = "Simon de Beauvoir's The 
Second Sex is Published", size = 3) +
  geom_segment(aes(x = 1946, y = 3, xend = 1946, yend = 0.6)) +
  annotate("text", x = 1966, y = 4.5, label = "Natonal Organization for Women is born", size = 3) +
  geom_segment(aes(x = 1966, y = 1.37, xend = 1966, yend = 4.3)) +
  annotate("text", x = 1960, y = 0, label = "First Oral Contraceptive 
is Approved by The FDA", size = 3) +
  geom_segment(aes(x = 1960, y = 0.4, xend = 1960, yend = 0.94)) +
  annotate("text", x = 1972, y = 3.4, label = "Legalization of 
Birth Control For All", size = 3) +
  geom_segment(aes(x = 1970, y = 1.06, xend = 1970, yend = 3)) +
  annotate("text", x = 1984, y = 1.5, label = "The Guerrilla Girls 
are Formed", size = 3) +
  geom_segment(aes(x = 1984, y = 1.9, xend = 1984, yend = 3.6)) +
  annotate("text", x = 1990, y = 7.5, label = "Third Wave Direct Action 
Corporation is Founded", size = 3) +
  geom_segment(aes(x = 1992, y = 5.69, xend = 1992, yend = 7)) +
  annotate("text", x = 2001, y = 9, label = "9/11 Attacks", size = 3) +
  geom_segment(aes(x = 2001, y = 7.9, xend = 2001, yend = 8.8)) 

female_director_graph_best_film
```

```{r, message=FALSE, warning=FALSE, error = FALSE, fig.width= 10, fig.height= 5, fig.align="center"}
#Graphic of the percentage of best film nominees that pass the Bechdel test
#It should also be noted that a few films from the early 1990s had to be omitted due to them not yet being classified
year <- c(2016, 2015, 2014, 2013, 2012, 2011, 2010, 2009, 2008, 2007, 2006, 2005, 2004, 2003, 2002, 2001, 2000, 1999, 1998, 1997, 1996, 1995, 1994, 1993, 1992, 1991, 1990)
percent_passing <- c(0.44, 0.5, 0.5, 0.67, 0.78, 0.44, 0.8, 0.3, 0.2, 0.6, 0.6, 0.4, 0.8, 0.4, 0.4, 0.5, 0.8, 0.75, 0.4, 0.4, 0.75, 0.75, 0.4, 0.4, 0.4, 1.00, 0.75)
bechdel_all_films <- data.frame(year, percent_passing)

bechdel_graph_best_film <- ggplot(bechdel_all_films, aes(x = year, y = percent_passing, fill = percent_passing)) + geom_bar(stat = "identity") + scale_fill_gradient(low="red", high="green") +
  theme_bw() +
  ylab("% of films that passed the Bechdel test") + 
  xlab("Award Year") + 
  ggtitle("Nominated for Picture and Passing the Bechdel Test") + theme(text=element_text(family="Times")) + scale_y_continuous(labels = scales::percent) + theme(legend.position="none")

bechdel_annotated <- bechdel_graph_best_film +
  annotate("text", x = 2000, y = 0.90, label = "George W. Bush elected", size = 3) +
  geom_segment(aes(x = 2000, y = 0.8, xend = 2000, yend = 0.88)) +
  annotate("text", x = 2015, y = 0.63, label = "Donald Trump", size = 3) +
  annotate("text", x = 2015, y = 0.6, label = "announces candidacy", size = 3) +
  geom_segment(aes(x = 2015, y = 0.5, xend = 2015, yend = 0.58)) +
  annotate("text", x = 1992, y = 0.5, label = "Bill Clinton elected", size = 3) + 
  geom_segment(aes(x = 1992, y = 0.4, xend = 1992, yend = 0.48)) +
  annotate("text", x = 2008, y = 0.3, label = "Barack Obama elected", size = 3) + 
  geom_segment(aes(x = 2008, y = 0.2, xend = 2008, yend = 0.28)) +
  annotate("text", x = 2004, y = 0.85, label = "Presidential election, John Kerry", size = 3) +
  geom_segment(aes(x = 2004, y = 0.8, xend = 2004, yend = 0.84)) +
  annotate("text", x = 2011, y = 0.52, label = "Republican primary campaigning begins", size = 3) +
  geom_segment(aes(x = 2011, y = 0.44, xend = 2011, yend = 0.5)) + 
  labs(caption = "Percentages of female Best Picture nominees from 1990 onward that passed the Bechdel test. Major events relating to presidential candidacies and elections are also noted. Any film that has
not yet been classified as passing or failing the Bechdel test has been omitted.") +
  theme(plot.caption = element_text(hjust=0, size=8)) + theme(text=element_text(family="Times"))

bechdel_annotated
```


This might lead to the logical jump forward that women’s work in Hollywood is also being celebrated with a greater frequency. With this in mind we examined movies that have received Best Picture nominations at the Oscars… Our findings were abysmally sad with there only being 12 films in the history of the Oscars to be directed by a woman and nominated for Best Picture. Even more upsetting is that none of these movies ever won Best Picture.

All of our data analysis thus far brought us to the Bechdel test, The Bechdel test is the result of a 1985 comic and is a simple test to see if a film has some level of gender equality. The test has three criteria:
1. The film has two women
2. The two women talk to each other
3. The women talk to each other about something other than a man/men.
Based on user-generated data on the Bechdel test’s website less than 60% of films analyzed have passed the test and if you omit data from films in the past few decades the numbers are much lower.

In contrast to the overall low passing rate of the Bechdel test, 90% of the female directed nominees for Best Picture pass the Bechdel test. Here you can see the same percentage graph from earlier with the female directed nominees denoted with round points. Points in green passed the Bechdel test, the point in red failed, and the point in yellow has not yet been evaluated the Bechdel test.

So what can we do based on this data? One important thing is to recognize and support movies that have females in important off-screen roles like director, writer and producer. Show movie companies that you want to see women involved in not just movies in general but also the big budget films that often end up receiving critical acclaim.

```{r, warning=FALSE, messages = FALSE}
#Making the table for Oscar winning, female directed movies. 
library(knitr)
library(kableExtra)

Oscar_Winners <- c("3420538", "3901612", "4200072", "4369038", "4374245", "4408215", "4565524", "4590482",
"4404940", "3890366", "3280928", "3314581")

Passed <- c(1, 2, 4, 5, 6, 8, 9, 10, 11, 12)

Oscars_directors_info <- movie_f_directors %>%
  filter(movie_id %in% Oscar_Winners, gender == "f") %>%
  ungroup() %>%
  arrange(production_year) %>% 
  select(production_year, title, name) %>%
  rename("Production Year" = production_year, Name = name, Title = title) %>%
  kable("html") %>%
  kable_styling(bootstrap_options = "striped") %>%
  row_spec(Passed, color = "white", background = "green") %>%
  row_spec(7, color = "white", background = "red")

Oscars_directors_info 
```













